# Прикладное программирование. Лабораторная работа №1
## Описание работы
**Цель работы**: изучить принцип работы ООП в Python, возможности обработки исключительных ситуаций, формирование форматов как XML и JSON.  
**Вариант**: интернет-магазин электроники (14)    
**Технологии**: python, диаграмма классов UML, формат данных XML и JSON.  
**Инструменты**: PyCharm/Draw.io.  
**Задача**:
1. Спроектировать диаграмму классов.  
2. Реализовать по спроектированной диаграмме классов рабочую программу.  
3. Обработать встроенные и собственное исключения. Актуализировать диаграмму классов.
4. Спроектировать структуру для хранения данных в формате XML и JSON.
5. Реализовать считывание из файла (десериализация) и запись в файл (сериализация) всех объектов программы в формат JSON.
## UML-диаграмма классов.
![рисунок 1](/Assignment_1/images/diag_classes.jpg)
## Листинг программы.
- Address: Класс, который хранит информацию об адресе пользователя сайта, который он указывает в своем профиле. Методы позволяют добавлять адрес, обновлять его.
- Cart: Описывает корзину на сайте, где пользователь может хранить свои покупки. Методы позволяют добавлять товары (Product) в корзину, просматривать корзину, удалять конкретный товар и полностью очищать корзину.  Дополнительные действия с этим классом реализованы в его классе-менеджере.
- Category: Класс категории, к которой относится товар. Методы позволяют добавлять товар в категорию и удалять его из категории, отображать все товары в конкретной категории.
- Inventory: Класс, представляющий склад с товарами. Методы позволяют управлять товарами на складе (добавление, удаление, обновление количества), обновлять цену конкретного товара, отображать информацию о товарах.  
- Order: Класс заказа, который содержит информацию о покупках. Содержит методы для добавления и отмены заказа.
- Payment: Класс, который управляет оплатой заказов. Содержит методы для обработки и возврата платежа.
- Product: Класс товара, который можно приобрести в магазине. Содержит методы для обновления цены товара и проверки наличия товара в магазине.
- Rating: Класс для оценки рейтинга товара. Метод по обновлению рейтинга.
- Review: Класс, представляющий отзывы на товары. Содержит методы добавления, удаления и редактирования отзыва.
- Seller: Класс, представляющий продавца/компанию, добавляющего(-ую) товары в магазин. 
- User: Представляет собой пользователя веб-магазина, с методами регистрации, входом и выходом из аккаунта.

Также для всех классов реализованы классы-менеджеры, позволяющие выполнять дополнительные CRUD-операции.
## Обработка исключений.
Для примера возьмём класс Product.  
1) В конструкторе, то есть при создании товара, проходит оценка стоимости и количества товара на влидность:
```Python
if price < 0:
    raise ValueError("Price cannot be negative.")
if stock < 0:
    raise ValueError("Stock cannot be negative.")
```
**Цена товара**: проводится встроенная проверка на положительность числа. В случае ошибки выбрасывает сообщение ValueError с ошибкой: "Price cannot be negative."    
**Количество товара**: проводится встроенная проверка на положительность числа. В случае ошибки выбрасывает сообщение ValueError с ошибкой : "Stock cannot be negative."      
2) В случае, когда товар добавляют в корзину, проводится проверка на наличие товара.  
```Python
class InsufficientStockError(Exception):
    def __init__(self, product_name: str, current_stock: int, requested_change: int):
        message = (f"Insufficient stock for product '{product_name}'. "
                   f"Current stock: {current_stock}, requested change: {requested_change}.")
        super().init(message)
```
Если запрошенное число товара превышает то, что в наличии, то выбрасывается ошибка с текстом: "Insufficient stock of product."  
## Сериализация и десериализация данных.
Разберём сериализацию и десериализацию на примере класса User.  
Дополнительно к классу прописаны классы UserJSONHandler для работы с файлами формата JSON и UserXMLHandler для работы с файлами формата XML.   
В каждом из классов реализованы методы CRUD.    
**Пример выполнения**:      
В main.py мы создаем объект класса User и добавляем его в UserJSONHandler.    
```Python
user_manager = UserManager()
json_handler = UserJSONHandler(json_file)

# Создание адреса и пользователя
print("\n--- Creating user in memory ---")
address1 = Address(1, 1, "Moscow", "Arbat", 15, 200)
user1 = user_manager.create("user1@example.com", "Alice", "+1234567890", address1)
print(f"Created user: {user1}")

# Сохранение пользователя в JSON
print("\n--- UserJSONHandler: Saving user to JSON ---")
try:
    json_handler.create(user1)
    print(f"User {user1.name} saved to JSON.")
except UserExistsError as e:
    print(e)
```
В итоге получаем файл users.json, в котором хранится информация о добавленном пользователе.    
```js
{
    "users": [
        {
            "user_id": 1,
            "email": "user1@example.com",
            "name": "Alice",
            "phone": "+1234567890",
            "address": {
                "city": "Moscow",
                "street": "Arbat",
                "house": 15,
                "apartment": 200
            }
        }
    ]
}
```
## Вывод    
В лабораторной работе была осуществлена проектировка диаграммы классов. В результате был разработан объектно-ориентированный код на Python, соответствующий созданной диаграмме.    
В ходе работы были обработаны как встроенные, так и собственные исключения, что обеспечило устойчивость программы.    
Дополнительно были спроектированы структуры для хранения данных в форматах JSON и XML. Реализованный код на Python позволяет считывать и записывать данные в этих форматах.    
В заключение, лабораторная работа позволила получить практический опыт в проектировании и реализации объектно-ориентированных систем, а также в работе с форматами хранения данных и обработкой ошибок.


